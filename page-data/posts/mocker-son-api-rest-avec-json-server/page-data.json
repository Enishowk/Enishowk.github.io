{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/mocker-son-api-rest-avec-json-server","result":{"data":{"markdownRemark":{"id":"3e1791c7-808c-5e0d-a0a6-b92884ddfbb4","html":"<p>L’intérêt de cet article et de vous faire découvrir une manière de mocker vos API REST, grâce à un petit outil, <strong><a href=\"https://github.com/typicode/json-server\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">json-server</a></strong>.</p>\n<p><strong>json-server</strong> est un mini serveur, fonctionnant avec nodeJS permettant d’exposer des ressources, via une URL.</p>\n<p>La phrase de présentation est simple :</p>\n<blockquote>\n<p>Get a full fake REST API with zero coding in less than 30 seconds (seriously)</p>\n</blockquote>\n<p>Et il faut avouer qu’ils ont raison. </p>\n<h1 id=\"installation\" style=\"position:relative;\"><a href=\"#installation\" aria-label=\"installation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Installation</h1>\n<p>Tout d’abord, pour l’installation, rien de plus simple :\n<code class=\"language-text\">$ npm install -g json-server</code></p>\n<p>Ensuite, créez-vous un fichier <code class=\"language-text\">db.json</code> qui contiendra vos données avec par exemple :</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"posts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span> <span class=\"token string\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"json-server\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"author\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"typicode\"</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"comments\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span> <span class=\"token string\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"body\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"some comment\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"postId\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"profile\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"typicode\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Pour finir, lancez le serveur grâce à cette commande :\n<code class=\"language-text\">$ json-server --watch db.json</code>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/aae04f6725bdbf918df37a44d0f52bb5/61946/launch-json-server.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.583333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABwElEQVQoz6XSvUsbYRzA8V/urkuLUUqHIiFqk3tJLi+Xl+dJLBp1sd27NC0dCkUimLZwDjq5uAmSxSUhuAUcHBwVOhX6N3SU0kXwXRGay3O//i5N0gylGH3gwz3cPffl4bkDoIHfvwXw6Osknh0yPP/J8ewHx6sjjpc3HM+vaX7Jm8fHvHV60p4jYj9G8iQE3bFgr1dKW3X8UGn8Km02RKmyIxY2tsXbTx9FsVwmtigu2eJNeVm8Wvws3tmr/ZrvV9bwddne6wVhIlkDs4Bg5BxQswgqQwilEcaMjijCuPlHMIIQ0InRoQsI0vPR8MEmgK/dk0JmVYnnUDJSTdAtF7SkC3rK9UWYK0W7sh3Mlc0+UebI8TxKurUP3aCiWdWnhZf4JD/nDGcL3hVHWAFpMe2admpk/qcF3jo1cdALylqy5udzOJSecvyZaXzMZ3A4O42KSQv1OwQlNVEbYrMU4M6DGEeFgJa6TezfQUW3qmBy72GTiAE57WA48fcMH8ZYXUo894IuROgrD8rM0Q6TX3pB+jUqoFnezRNyMaBTeteBZ7HdbtDnkxUVZHkeJPnFPZje6QEEwtApy/ckwSM//AZfKCQPBVMY9wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/aae04f6725bdbf918df37a44d0f52bb5/8ac56/launch-json-server.webp 240w,\n/static/aae04f6725bdbf918df37a44d0f52bb5/d3be9/launch-json-server.webp 480w,\n/static/aae04f6725bdbf918df37a44d0f52bb5/e46b2/launch-json-server.webp 960w,\n/static/aae04f6725bdbf918df37a44d0f52bb5/f992d/launch-json-server.webp 1440w,\n/static/aae04f6725bdbf918df37a44d0f52bb5/87ef7/launch-json-server.webp 1546w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/aae04f6725bdbf918df37a44d0f52bb5/8ff5a/launch-json-server.png 240w,\n/static/aae04f6725bdbf918df37a44d0f52bb5/e85cb/launch-json-server.png 480w,\n/static/aae04f6725bdbf918df37a44d0f52bb5/d9199/launch-json-server.png 960w,\n/static/aae04f6725bdbf918df37a44d0f52bb5/07a9c/launch-json-server.png 1440w,\n/static/aae04f6725bdbf918df37a44d0f52bb5/61946/launch-json-server.png 1546w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/aae04f6725bdbf918df37a44d0f52bb5/d9199/launch-json-server.png\"\n          alt=\"launch-json-server\"\n          title=\"launch-json-server\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<p>Et voilà.</p>\n<p>Vous pouvez également vous rendre sur <a href=\"http://localhost:3000\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://localhost:3000</a> afin d’obtenir une liste des ressources et méthodes HTTP disponible.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 121.25000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAABYlAAAWJQFJUiTwAAACgUlEQVQ4y51UTY/SYBAu0b3ozR9h/BXbgz/A8yYe/QEYCAdY9WhiFBI2sBASTp6WLDEaxYsX9ejNi9GDblulUL773bdlnHmhpAstdp3kybzvtPN0pvMhCCi3BOE2qrvC9WuH3Y/fxPPPP8QPX4fip+9z8YsSiPeOHoj4PAmH3FcQ7gihPM0/fPmsUoLSk8e+rPThj6qBNp7CdK6D6wXw9l0PCoUClEolDjrncjkoFouQz+f94+NHkM1mzzeEPyW5Ayg+85lt23SE2XQKw+EQDF2HbQmCAFzX5WfP8xhpVR282RDKknSmo6OiKAyxVFV1ie9sgAQb+L6/JAntKJyw3+9HCOVVhAyFvkwgnxQg0l1CjIoTYrqM0iFJSxhGiFntRjgYDBj+E4iTVZZx5hhCSZI65DAajZimaTCbzTgmkzFiAoZhJEUdTximvFgseJUp7W1ECaPh7U0ZI2FhO6RJOZGQUiYjpsgsy4pNL440mVBWOmTVnYCRTxJB6ggvcFIoLlnTmWU7qdsmscq/pN+cUNcNBleQPUVZVdl1HV4UqjRpx3FoVvmZtG3Z/Bm1EY7g/j6kF9DI+5CAZ2p0rumOo8WJiJDmfi9h2DYYEUboAS0Qy15FQ1WnSA3TvHrbzGcTNtKG1OCJvZiqKJJ0wQn7E4uN5xZtnX9Vd/8sbybFXTLXh0u7MA5bEjvLZ/xzAfOCwA/wh6+By46xSyA7rcEIvPU+fB0lfMWXA1YvbBsqBPqCaVpYGBu1CSYWaL3xdwQ74n3Il6lUKkftdvuk0Wg8bzab5RB4L0fvKzTK9dPTcr1e56jVai9ardZJtVq9z9m63W4G1QHiBuLmf4J8D3q9XuYv4Mfm0lHVRdcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/82a2218332bd7472b62fe0043c31ab91/8ac56/json-server-localhost.webp 240w,\n/static/82a2218332bd7472b62fe0043c31ab91/d3be9/json-server-localhost.webp 480w,\n/static/82a2218332bd7472b62fe0043c31ab91/e46b2/json-server-localhost.webp 960w,\n/static/82a2218332bd7472b62fe0043c31ab91/f992d/json-server-localhost.webp 1440w,\n/static/82a2218332bd7472b62fe0043c31ab91/ba360/json-server-localhost.webp 1630w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/82a2218332bd7472b62fe0043c31ab91/8ff5a/json-server-localhost.png 240w,\n/static/82a2218332bd7472b62fe0043c31ab91/e85cb/json-server-localhost.png 480w,\n/static/82a2218332bd7472b62fe0043c31ab91/d9199/json-server-localhost.png 960w,\n/static/82a2218332bd7472b62fe0043c31ab91/07a9c/json-server-localhost.png 1440w,\n/static/82a2218332bd7472b62fe0043c31ab91/1e5d2/json-server-localhost.png 1630w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/82a2218332bd7472b62fe0043c31ab91/d9199/json-server-localhost.png\"\n          alt=\"json-server-localhost\"\n          title=\"json-server-localhost\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n    </span></p>\n<p>Vous l’aurez compris, une simple requête GET sur l’url <a href=\"http://localhost:3000/posts/1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://localhost:3000/posts/1</a> et vous obtiendrez votre ressource “posts” qui correspond à l’id 1.</p>\n<h1 id=\"customisation\" style=\"position:relative;\"><a href=\"#customisation\" aria-label=\"customisation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Customisation</h1>\n<p>La documentation de <strong>json-server</strong> est très bien fournie, et vous permettra de tout personnaliser afin que cela ressemble exactement à votre réelle API.</p>\n<p>Personnellement, je l’utilise couplé à <strong><a href=\"https://github.com/axios/axios\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Axios</a></strong> sur des projets React par exemple. Cela permet, en changeant une seule ligne de config, de passer de notre vrai back, au serveur json afin de mocker les données.</p>\n<blockquote>\n<p>Si vous travaillez avec <strong>React</strong> et <strong>Browser-sync</strong>, il y a de fortes chances pour que votre port 3000 soit déjà utilisé. </p>\n</blockquote>\n<p>Vous pouvez donc au choix, exécuter cette commande :\n<code class=\"language-text\">$ json-server --watch db.json --port 3100</code>  </p>\n<p>Ou bien créer un fichier de config <code class=\"language-text\">json-server.json</code> et y ajouter :</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">3100</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Afin de coller exactement avec votre back, il est possible de défini ses propres <a href=\"https://github.com/typicode/json-server#add-custom-routes\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">routes</a> afin de récupérer ses ressources.\nLes routes sont à ajouter dans un fichier <code class=\"language-text\">routes.json</code>. Voici un exemple de routes custom :</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"/posts/:category\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/posts?category=:category\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"/articles\\\\?id=:id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/posts/:id\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Cela va définir les routes comme ceci :</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">/</span>posts<span class=\"token operator\">/</span>javascript # → <span class=\"token operator\">/</span>posts<span class=\"token operator\">?</span>category<span class=\"token operator\">=</span>javascript\n<span class=\"token operator\">/</span>articles<span class=\"token operator\">?</span>id<span class=\"token operator\">=</span><span class=\"token number\">1</span> # → <span class=\"token operator\">/</span>posts<span class=\"token operator\">/</span><span class=\"token number\">1</span></code></pre></div>\n<p>Enfin, il ne reste plus qu’à ajouter un petit alias NPM/Yarn dans votre <code class=\"language-text\">package.json</code> afin de lancer le server plus simplement :</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token string\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"json:server\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"json-server --watch db.json -c json-server.json --routes routes.json\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>Toute modification des fichiers de config est prise en charge instannément. Inutile de relancer le serveur.  </p>\n<p>Pour finir, voici quelques utilisations possibles :<br>\n<strong>Filter</strong> : <code class=\"language-text\">GET /posts?title=json-server&amp;author=typicode</code><br>\n<strong>Paginate</strong> or <strong>Limit</strong> : <code class=\"language-text\">GET /posts?_page=7&amp;_limit=20</code><br>\n<strong>Sort</strong> / <strong>Order</strong> : <code class=\"language-text\">GET /posts?_sort=views&amp;_order=asc</code><br>\n<strong>Search</strong> : <code class=\"language-text\">GET /posts?q=internet</code>  </p>\n<p>Quelques liens pour générer des données au format JSON :\n<a href=\"https://github.com/Marak/faker.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/Marak/faker.js</a>\n<a href=\"https://github.com/boo1ean/casual\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/boo1ean/casual</a>\n<a href=\"https://www.json-generator.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.json-generator.com/</a></p>\n<p>Si vous avez des questions ou des suggestions, je suis disponible sur <a href=\"https://twitter.com/Enish__\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Twitter</a>. 😉</p>","fields":{"slug":"/posts/mocker-son-api-rest-avec-json-server","tagSlugs":["/tag/blog/","/tag/dev/"]},"frontmatter":{"date":"2017-11-23","description":"Lorsque l'on développe le front d'une application web basé sur une API REST, il peut arriver que les ressources back ne soient pas encore disponibles. Ou que le serveur qui héberge notre back tombe en rade. On se retrouve donc bloqué, avec un front sans ressource disponible.","tags":["Blog","Dev"],"title":"Mocker son API REST avec Json-server"}}},"pageContext":{"slug":"/posts/mocker-son-api-rest-avec-json-server"}},"staticQueryHashes":["1307906156","251939775","401334301"]}